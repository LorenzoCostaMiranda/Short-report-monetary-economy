ylab = "M2", xlab = "Data", cex.lab = 2.0, cex.axis = 1.5)
par(new = TRUE)
plot(ImpcAgre$Data, ImpcAgre$SELIC, type = "l",
col = "cyan", axes = FALSE, xlab = "", ylab = "",
ylim = c(min(ImpcAgre$SELIC),
max(ImpcAgre$SELIC)))
axis(side =  4, at = pretty(range(ImpcAgre$SELIC)))
mtext("Taxa Selic (%)", side = 4, line = 3)
# Fazendo o mesmo para M3 e SELIC
plot(ImpcAgre$Data, ImpcAgre$M3, type = "l",
col = "yellow", ylim = c(min(ImpcAgre$M3),
max(ImpcAgre$M3)),
ylab = "M3", xlab = "Data", cex.lab = 2.0, cex.axis = 1.5)
par(new = TRUE)
plot(ImpcAgre$Data, ImpcAgre$SELIC, type = "l",
col = "cyan", axes = FALSE, xlab = "", ylab = "",
ylim = c(min(ImpcAgre$SELIC),
max(ImpcAgre$SELIC)))
axis(side =  4, at = pretty(range(ImpcAgre$SELIC)))
mtext("Taxa Selic (%)", side = 4, line = 3)
# Fazendo o mesmo para M4 e SELIC
plot(ImpcAgre$Data, ImpcAgre$M4, type = "l",
col = "orange", ylim = c(min(ImpcAgre$M4),
max(ImpcAgre$M4)),
ylab = "M4", xlab = "Data", cex.lab = 2.0, cex.axis = 1.5)
par(new = TRUE)
plot(ImpcAgre$Data, ImpcAgre$SELIC, type = "l",
col = "cyan", axes = FALSE, xlab = "", ylab = "",
ylim = c(min(ImpcAgre$SELIC),
max(ImpcAgre$SELIC)))
axis(side =  4, at = pretty(range(ImpcAgre$SELIC)))
mtext("Taxa Selic (%)", side = 4, line = 3)
par(mfrow = c(1,1))
mtext("Comparação Entre os Agregados e a Selic", outer = TRUE, cex = 1.5, line = 2)
#Criando uma gráfico plotly com M1 e IPCA
p9 <- plot_ly() %>%
add_lines(data = Variacoes_Percentuais, x = ~Data, y = ~`M1 (%)`, name = "M1 (%)", color = I("green")) %>%
add_lines(data = Variacoes_Percentuais, x = ~Data, y = ~`IPCA (%)`, name = "IPCA (%)", color = I('purple2'),
yaxis = "y2")
p9 <- p9 %>%
layout(
title = "M1 em relação ao IPCA",
yaxis = list(title = "M1"),
yaxis2 = list(
title = "IPCA",
overlaying = "y",
side = "right"
)
)
p9
# Fazendo o mesmo para M2 e IPCA
p6 <- plot_ly() %>%
add_lines(data = Variacoes_Percentuais, x = ~Data, y = ~`M2 (%)`, name = "M2 (%)", color = I("lawngreen")) %>%
add_lines(data = Variacoes_Percentuais, x = ~Data, y = ~`IPCA (%)`, name = "IPCA (%)", color = I('purple2'),
yaxis = "y2")
p6 <- p6 %>%
layout(
title = "M2 em relação ao IPCA",
yaxis = list(title = "M2"),
yaxis2 = list(
title = "IPCA",
overlaying = "y",
side = "right"
)
)
p6
# Fazendo o mesmo para M3 e IPCA
p7 <- plot_ly() %>%
add_lines(data = Variacoes_Percentuais, x = ~Data, y = ~`M3 (%)`, name = "M3 (%)", color = I("yellow")) %>%
add_lines(data = Variacoes_Percentuais, x = ~Data, y = ~`IPCA (%)`, name = "IPCA (%)", color = I('purple2'),
yaxis = "y2")
p7 <- p7 %>%
layout(
title = "M3 em relação ao IPCA",
yaxis = list(title = "M3"),
yaxis2 = list(
title = "IPCA",
overlaying = "y",
side = "right"
)
)
p7
# Fazendo o mesmo para M4 e IPCA
p8 <- plot_ly() %>%
add_lines(data = Variacoes_Percentuais, x = ~Data, y = ~`M4 (%)`, name = "M4 (%)", color = I("orange")) %>%
add_lines(data = Variacoes_Percentuais, x = ~Data, y = ~`IPCA (%)`, name = "IPCA (%)", color = I('purple2'),
yaxis = "y2")
p8 <- p8 %>%
layout(
title = "M4 em relação ao IPCA",
yaxis = list(title = "M4"),
yaxis2 = list(
title = "IPCA",
overlaying = "y",
side = "right"
)
)
p8
colnames(impcPib)[colnames(impcPib) == "Variação Percentual (%)"] <- "Variação_Percentual"
colnames(impcPib)[colnames(impcPib) == "PIB valores correntes(milhões)"] <- "PIB_Valores_Correntes_milhoes"
Plotpib2 <- plot_ly() %>%
add_lines(data = impcPib, x = ~Data, y = ~PIB_Valores_Correntes_milhoes, name = "PIB valores correntes(milhões)", color = I("darkblue")) %>%
add_lines(data = impcPib, x = ~Data, y = ~Variação_Percentual, name = "PIB em Variação Percentual (%)", yaxis = "y2", color = I("blue"))
# Configuração do layout com múltiplos eixos Y
Plotpib2 <- Plotpib2 %>%
layout(
autosize = F, # Desativa o dimensionamento automático
width = 800,  # Largura do gráfico em pixels
height = 600, # Altura do gráfico em pixels
margin = list(l = 50, r = 50, b = 100, t = 100, pad = 4),
title = "PIB e a variação nos anos próximos",
yaxis = list(title = "PIB a valores correntes"),
yaxis2 = list(
title = "PIB em Variação Percentual (%)",
overlaying = "y",
side = "right",
anchor = "free",
position = 1.00
)
)
# Renderização do gráfico
Plotpib2
View(p4)
#Criando Tabela de Correlação entre os Agregados monetários e a Taxa Selic
#sapply(TabelaPIB, class)
#  add_lines(data = TabelaAgregados, x = ~Data, y = ~IPCA, name = "IPCA", color = I("pink"),
#yaxis = "y2")
#Criando uma gráfico plotly com M1 e IPCA
#Criando uma gráfico plotly com M1 e IPCA
p4 <- plot_ly() %>%
add_lines(data = Variacoes_Percentuais, x = ~Data, y = ~`M1 (%)`, name = "M1 (%)", color = I("green")) %>%
add_lines(data = Variacoes_Percentuais, x = ~Data, y = ~`IPCA (%)`, name = "IPCA (%)", color = I('purple2'),
yaxis = "y2")
library(zoo)
library(plotly)
library(htmltools)
library(GetBCBData)
library(dplyr)
library(pandoc)
library(ggplot2)
library(tibble)
library(tidyr)
library(kableExtra)
library(flextable)
library(openxlsx)
library(scales)
library(reshape2)
library(patchwork)
library(corrplot)
#Criando Tabela de Correlação entre os Agregados monetários e a Taxa Selic
#sapply(TabelaPIB, class)
#  add_lines(data = TabelaAgregados, x = ~Data, y = ~IPCA, name = "IPCA", color = I("pink"),
#yaxis = "y2")
#Criando uma gráfico plotly com M1 e IPCA
#Criando uma gráfico plotly com M1 e IPCA
p4 <- plot_ly() %>%
add_lines(data = VariacoesPercentuais, x = ~Data, y = ~`M1 (%)`, name = "M1 (%)", color = I("green")) %>%
add_lines(data = VariacoesPercentuais, x = ~Data, y = ~`IPCA (%)`, name = "IPCA (%)", color = I('purple2'),
yaxis = "y2")
p4 <- p4 %>%
layout(
title = "M1 em relação ao IPCA",
yaxis = list(title = "M1"),
yaxis2 = list(
title = "IPCA",
overlaying = "y",
side = "right"
)
)
p4
# Fazendo o mesmo para M2 e IPCA
p3 <- plot_ly() %>%
add_lines(data = VariacoesPercentuais, x = ~Data, y = ~`M2 (%)`, name = "M2 (%)", color = I("lawngreen")) %>%
add_lines(data = VariacoesPercentuais, x = ~Data, y = ~`IPCA (%)`, name = "IPCA (%)", color = I('purple2'),
yaxis = "y2")
p3<- p3 %>%
layout(
title = "M2 em relação ao IPCA",
yaxis = list(title = "M2"),
yaxis2 = list(
title = "IPCA",
overlaying = "y",
side = "right"
)
)
p3
# Fazendo o mesmo para M3 e IPCA
p2 <- plot_ly() %>%
add_lines(data = VariacoesPercentuais, x = ~Data, y = ~`M3 (%)`, name = "M3 (%)", color = I("yellow")) %>%
add_lines(data = VariacoesPercentuais, x = ~Data, y = ~`IPCA (%)`, name = "IPCA (%)", color = I('purple2'),
yaxis = "y2")
p2 <- p2 %>%
layout(
title = "M3 em relação ao IPCA",
yaxis = list(title = "M3"),
yaxis2 = list(
title = "IPCA",
overlaying = "y",
side = "right"
)
)
p2
# Fazendo o mesmo para M4 e IPCA
p1 <- plot_ly() %>%
add_lines(data = VariacoesPercentuais, x = ~Data, y = ~`M4 (%)`, name = "M4 (%)", color = I("orange")) %>%
add_lines(data = VariacoesPercentuais, x = ~Data, y = ~`IPCA (%)`, name = "IPCA (%)", color = I('purple2'),
yaxis = "y2")
p1 <- p1 %>%
layout(
title = "M4 em relação ao IPCA",
yaxis = list(title = "M4"),
yaxis2 = list(
title = "IPCA",
overlaying = "y",
side = "right"
)
)
p1
View(TabelaAnos)
#Criando Tabela de Correlação entre os Agregados monetários e a Taxa Selic
#sapply(TabelaPIB, class)
#  add_lines(data = TabelaAgregados, x = ~Data, y = ~IPCA, name = "IPCA", color = I("pink"),
#yaxis = "y2")
#Criando uma gráfico plotly com M1 e IPCA
p4 <- plot_ly() %>%
add_lines(data = TabelaAnos, x = ~Data, y = ~`Variacao Percentual M1`, name = "M1 (%)", color = I("green")) %>%
add_lines(data = TabelaAnos, x = ~Data, y = ~`Variacao Percentual Ipca`, name = "IPCA (%)", color = I('purple2'),
yaxis = "y2")
p4 <- p4 %>%
layout(
title = "M1 em relação ao IPCA",
yaxis = list(title = "M1"),
yaxis2 = list(
title = "IPCA",
overlaying = "y",
side = "right"
)
)
p4
#Criando Tabela de Correlação entre os Agregados monetários e a Taxa Selic
#sapply(TabelaPIB, class)
#  add_lines(data = TabelaAgregados, x = ~Data, y = ~IPCA, name = "IPCA", color = I("pink"),
#yaxis = "y2")
#Criando uma gráfico plotly com M1 e IPCA
p4 <- plot_ly() %>%
add_lines(data = TabelaAnos, x = ~anos, y = ~`Variacao Percentual M1`, name = "M1 (%)", color = I("green")) %>%
add_lines(data = TabelaAnos, x = ~anos, y = ~`Variacao Percentual Ipca`, name = "IPCA (%)", color = I('purple2'),
yaxis = "y2")
p4 <- p4 %>%
layout(
title = "M1 em relação ao IPCA",
yaxis = list(title = "M1"),
yaxis2 = list(
title = "IPCA",
overlaying = "y",
side = "right"
)
)
p4
#Criando Tabela de Correlação entre os Agregados monetários e a Taxa Selic
#sapply(TabelaPIB, class)
#  add_lines(data = TabelaAgregados, x = ~Data, y = ~IPCA, name = "IPCA", color = I("pink"),
#yaxis = "y2")
#Criando uma gráfico plotly com M1 e IPCA
p4 <- plot_ly() %>%
add_lines(data = TabelaAnos, x = ~ano, y = ~`Variacao Percentual M1`, name = "M1 (%)", color = I("green")) %>%
add_lines(data = TabelaAnos, x = ~ano, y = ~`Variacao Percentual Ipca`, name = "IPCA (%)", color = I('purple2'),
yaxis = "y2")
p4 <- p4 %>%
layout(
title = "M1 em relação ao IPCA",
yaxis = list(title = "M1"),
yaxis2 = list(
title = "IPCA",
overlaying = "y",
side = "right"
)
)
p4
# Fazendo o mesmo para M2 e IPCA
p3 <- plot_ly() %>%
add_lines(data = TabelaAnos, x = ~ano, y = ~`Variacao Percentual M2`, name = "M2 (%)", color = I("lawngreen")) %>%
add_lines(data = TabelaAnos, x = ~ano, y = ~`Variacao Percentual Ipca`, name = "IPCA (%)", color = I('purple2'),
yaxis = "y2")
p3<- p3 %>%
layout(
title = "M2 em relação ao IPCA",
yaxis = list(title = "M2"),
yaxis2 = list(
title = "IPCA",
overlaying = "y",
side = "right"
)
)
p3
# Fazendo o mesmo para M3 e IPCA
p2 <- plot_ly() %>%
add_lines(data = VariacoesPercentuais, x = ~ano, y = ~`Variacao Percentual M3`, name = "M3 (%)", color = I("yellow")) %>%
add_lines(data = VariacoesPercentuais, x = ~ano, y = ~`Variacao Percentual Ipca`, name = "IPCA (%)", color = I('purple2'),
yaxis = "y2")
p2 <- p2 %>%
layout(
title = "M3 em relação ao IPCA",
yaxis = list(title = "M3"),
yaxis2 = list(
title = "IPCA",
overlaying = "y",
side = "right"
)
)
p2
#Criando Tabela de Correlação entre os Agregados monetários e a Taxa Selic
#sapply(TabelaPIB, class)
#  add_lines(data = TabelaAgregados, x = ~Data, y = ~IPCA, name = "IPCA", color = I("pink"),
#yaxis = "y2")
#Criando uma gráfico plotly com M1 e IPCA
p4 <- plot_ly() %>%
add_lines(data = TabelaAnos, x = ~ano, y = ~`Variacao Percentual M1`, name = "M1 (%)", color = I("green")) %>%
add_lines(data = TabelaAnos, x = ~ano, y = ~`Variacao Percentual Ipca`, name = "IPCA (%)", color = I('purple2'),
yaxis = "y2")
p4 <- p4 %>%
layout(
title = "M1 em relação ao IPCA",
yaxis = list(title = "M1"),
yaxis2 = list(
title = "IPCA",
overlaying = "y",
side = "right"
)
)
p4
# Fazendo o mesmo para M2 e IPCA
p3 <- plot_ly() %>%
add_lines(data = TabelaAnos, x = ~ano, y = ~`Variacao Percentual M2`, name = "M2 (%)", color = I("lawngreen")) %>%
add_lines(data = TabelaAnos, x = ~ano, y = ~`Variacao Percentual Ipca`, name = "IPCA (%)", color = I('purple2'),
yaxis = "y2")
p3<- p3 %>%
layout(
title = "M2 em relação ao IPCA",
yaxis = list(title = "M2"),
yaxis2 = list(
title = "IPCA",
overlaying = "y",
side = "right"
)
)
p3
# Fazendo o mesmo para M3 e IPCA
p2 <- plot_ly() %>%
add_lines(data = VariacoesPercentuais, x = ~ano, y = ~`Variacao Percentual M3`, name = "M3 (%)", color = I("yellow")) %>%
add_lines(data = VariacoesPercentuais, x = ~ano, y = ~`Variacao Percentual Ipca`, name = "IPCA (%)", color = I('purple2'),
yaxis = "y2")
p2 <- p2 %>%
layout(
title = "M3 em relação ao IPCA",
yaxis = list(title = "M3"),
yaxis2 = list(
title = "IPCA",
overlaying = "y",
side = "right"
)
)
p2
## Importante, e mudança de IDEIA!! Agora toda a análise geral será feita em anos, e não meses. Só será em meses na
# Análise específica
TabelaAnos <- TabelaAgregados %>%
mutate(ano = lubridate::year(Data)) %>%
group_by(ano) %>%
summarize(media_m1 = mean(M1),
media_m2 = mean(M2),
media_m3 = mean(M3),
media_m4 = mean(M4),
media_selic = mean(SELIC),
media_ipca = mean(IPCA))
diff_selicano <- diff(TabelaAnos$media_selic)
percento_selicano <- (diff_selicano / head(TabelaAnos$media_selic, -1)) * 100
selicano_vari <- c(NA, percento_selicano)
diff_ipcaano <- diff(TabelaAnos$media_ipca)
percento_ipcaano <- (diff_ipcaano / head(TabelaAnos$media_ipca, -1)) * 100
ipcaano_vari <- c(NA, percento_ipcaano)
diff_m1ano <- diff(TabelaAnos$media_m1)
percento_m1ano <- (diff_m1ano / head(TabelaAnos$media_m1, -1)) * 100
m1ano_vari <- c(NA, percento_m1ano)
diff_m2ano <- diff(TabelaAnos$media_m2)
percento_m2ano <- (diff_m2ano / head(TabelaAnos$media_m2, -1)) * 100
m2ano_vari <- c(NA, percento_m2ano)
diff_m3ano <- diff(TabelaAnos$media_m3)
percento_m3ano <- (diff_m3ano / head(TabelaAnos$media_m3, -1)) * 100
m3ano_vari <- c(NA, percento_m3ano)
diff_m4ano <- diff(TabelaAnos$media_m4)
percento_m4ano <- (diff_m4ano / head(TabelaAnos$media_m4, -1)) * 100
m4ano_vari <- c(NA, percento_m4ano)
TabelaAnos <- TabelaAnos %>%
add_column("Variacao Percentual Selic" = selicano_vari, "Variacao Percentual Ipca" = ipcaano_vari,
"Variacao Percentual M1" = m1ano_vari, "Variacao Percentual M2" = m2ano_vari,
"Variacao Percentual M3" = m3ano_vari, "Variacao Percentual M4" = m4ano_vari, .after = "media_selic")
#view(TabelaAnos)
p99 <- plot_ly() %>%
add_lines(data = TabelaAnos, x = ~ano, y = ~`Variacao Percentual M1`, name = "M1 (%)", color = I("green")) %>%
add_lines(data = TabelaAnos, x = ~ano, y = ~`Variacao Percentual Selic`, name = "SELIC (%)", color = I('cyan'),
yaxis = "y2")
p99 <- p99 %>%
layout(
title = "M1 em relação à SELIC Agregados em Anos",
yaxis = list(title = "M1"),
yaxis2 = list(
title = "SELIC",
overlaying = "y",
side = "right"
)
)
p99
#Fazendo o mesmo para M2 e IPCA
p98 <- plot_ly() %>%
add_lines(data = TabelaAnos, x = ~ano, y = ~`Variacao Percentual M2`, name = "M2 (%)", color = I("lawngreen")) %>%
add_lines(data = TabelaAnos, x = ~ano, y = ~`Variacao Percentual Selic`, name = "IPCA (%)", color = I('cyan'),
yaxis = "y2")
p98 <- p98 %>%
layout(
title = "M2 em relação à SELIC Agregados em Anos",
yaxis = list(title = "M2"),
yaxis2 = list(
title = "IPCA",
overlaying = "y",
side = "right"
)
)
p98
# Fazendo o mesmo para M3 e IPCA
p97 <- plot_ly() %>%
add_lines(data = TabelaAnos, x = ~ano, y = ~`Variacao Percentual M3`, name = "M3 (%)", color = I("yellow")) %>%
add_lines(data = TabelaAnos, x = ~ano, y = ~`Variacao Percentual Selic`, name = "IPCA (%)", color = I('cyan'),
yaxis = "y2")
p97 <- p97 %>%
layout(
title = "M3 em relação à SELIC Agregados em Anos",
yaxis = list(title = "M3"),
yaxis2 = list(
title = "IPCA",
overlaying = "y",
side = "right"
)
)
p97
# Fazendo o mesmo para M4 e IPCA
p96 <- plot_ly() %>%
add_lines(data = TabelaAnos, x = ~ano, y = ~`Variacao Percentual M4`, name = "M4 (%)", color = I("orange")) %>%
add_lines(data = TabelaAnos, x = ~ano, y = ~`Variacao Percentual Selic`, name = "IPCA (%)", color = I('cyan'),
yaxis = "y2")
p96 <- p96 %>%
layout(
title = "M4 em relação à SELIC Agregados em Anos",
yaxis = list(title = "M4"),
yaxis2 = list(
title = "IPCA",
overlaying = "y",
side = "right"
)
)
p96
#Criando Tabela de Correlação entre os Agregados monetários e a Taxa Selic
#sapply(TabelaPIB, class)
#  add_lines(data = TabelaAgregados, x = ~Data, y = ~IPCA, name = "IPCA", color = I("pink"),
#yaxis = "y2")
#Criando uma gráfico plotly com M1 e IPCA
p4 <- plot_ly() %>%
add_lines(data = TabelaAnos, x = ~ano, y = ~`Variacao Percentual M1`, name = "M1 (%)", color = I("green")) %>%
add_lines(data = TabelaAnos, x = ~ano, y = ~`Variacao Percentual Ipca`, name = "IPCA (%)", color = I('purple2'),
yaxis = "y2")
p4 <- p4 %>%
layout(
title = "M1 em relação ao IPCA",
yaxis = list(title = "M1"),
yaxis2 = list(
title = "IPCA",
overlaying = "y",
side = "right"
)
)
p4
# Fazendo o mesmo para M2 e IPCA
p3 <- plot_ly() %>%
add_lines(data = TabelaAnos, x = ~ano, y = ~`Variacao Percentual M2`, name = "M2 (%)", color = I("lawngreen")) %>%
add_lines(data = TabelaAnos, x = ~ano, y = ~`Variacao Percentual Ipca`, name = "IPCA (%)", color = I('purple2'),
yaxis = "y2")
p3<- p3 %>%
layout(
title = "M2 em relação ao IPCA",
yaxis = list(title = "M2"),
yaxis2 = list(
title = "IPCA",
overlaying = "y",
side = "right"
)
)
p3
# Fazendo o mesmo para M3 e IPCA
p2 <- plot_ly() %>%
add_lines(data = VariacoesPercentuais, x = ~ano, y = ~`Variacao Percentual M3`, name = "M3 (%)", color = I("yellow")) %>%
add_lines(data = VariacoesPercentuais, x = ~ano, y = ~`Variacao Percentual Ipca`, name = "IPCA (%)", color = I('purple2'),
yaxis = "y2")
p2 <- p2 %>%
layout(
title = "M3 em relação ao IPCA",
yaxis = list(title = "M3"),
yaxis2 = list(
title = "IPCA",
overlaying = "y",
side = "right"
)
)
p2
